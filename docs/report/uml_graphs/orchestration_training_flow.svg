<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="676px" preserveAspectRatio="none" style="width:2580px;height:676px;background:#FFFFFF;" version="1.1" viewBox="0 0 2580 676" width="2580px" zoomAndPan="magnify"><defs/><g><!--MD5=[f2cf5bc806ad92efcc5f70ccc4575a54]
cluster Observation Spaces--><g id="cluster_Observation Spaces"><path d="M8.5,294 L167.5,294 A3.75,3.75 0 0 1 170,296.5 L177,316.2969 L460.5,316.2969 A2.5,2.5 0 0 1 463,318.7969 L463,520.5 A2.5,2.5 0 0 1 460.5,523 L8.5,523 A2.5,2.5 0 0 1 6,520.5 L6,296.5 A2.5,2.5 0 0 1 8.5,294 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="177" y1="316.2969" y2="316.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="158" x="10" y="308.9951">Observation Spaces</text></g><!--MD5=[027ebfd53c01aea08f474edbf35d0797]
cluster Models--><g id="cluster_Models"><path d="M787.5,572 L844.5,572 A3.75,3.75 0 0 1 847,574.5 L854,594.2969 L1579.5,594.2969 A2.5,2.5 0 0 1 1582,596.7969 L1582,666.5 A2.5,2.5 0 0 1 1579.5,669 L787.5,669 A2.5,2.5 0 0 1 785,666.5 L785,574.5 A2.5,2.5 0 0 1 787.5,572 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="785" x2="854" y1="594.2969" y2="594.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="56" x="789" y="586.9951">Models</text></g><!--MD5=[fc9cb75bda2984ef730daffb5e240d1c]
cluster MAPPO_Agent--><g id="cluster_MAPPO_Agent"><path d="M579.5,426 L690.5,426 A3.75,3.75 0 0 1 693,428.5 L700,448.2969 L758.5,448.2969 A2.5,2.5 0 0 1 761,450.7969 L761,666.5 A2.5,2.5 0 0 1 758.5,669 L579.5,669 A2.5,2.5 0 0 1 577,666.5 L577,428.5 A2.5,2.5 0 0 1 579.5,426 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="577" x2="700" y1="448.2969" y2="448.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="110" x="581" y="440.9951">MAPPO_Agent</text></g><!--MD5=[93dd51afb699efd04a6555232aabc247]
cluster Training_Utils--><g id="cluster_Training_Utils"><path d="M594.5,136 L700.5,136 A3.75,3.75 0 0 1 703,138.5 L710,158.2969 L1662.5,158.2969 A2.5,2.5 0 0 1 1665,160.7969 L1665,374.5 A2.5,2.5 0 0 1 1662.5,377 L594.5,377 A2.5,2.5 0 0 1 592,374.5 L592,138.5 A2.5,2.5 0 0 1 594.5,136 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="592" x2="710" y1="158.2969" y2="158.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="105" x="596" y="150.9951">Training_Utils</text></g><!--MD5=[04e44f4989af585ad7805c1854d544a0]
cluster PFSP & Archive--><g id="cluster_PFSP &amp; Archive"><path d="M1691.5,280 L1814.5,280 A3.75,3.75 0 0 1 1817,282.5 L1824,302.2969 L2408.5,302.2969 A2.5,2.5 0 0 1 2411,304.7969 L2411,520.5 A2.5,2.5 0 0 1 2408.5,523 L1691.5,523 A2.5,2.5 0 0 1 1689,520.5 L1689,282.5 A2.5,2.5 0 0 1 1691.5,280 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1689" x2="1824" y1="302.2969" y2="302.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="122" x="1693" y="294.9951">PFSP &amp; Archive</text></g><!--MD5=[19ac916ec0cceff7b84719a979ff29ca]
cluster Orchestration--><g id="cluster_Orchestration"><path d="M1774.5,6 L1884.5,6 A3.75,3.75 0 0 1 1887,8.5 L1894,28.2969 L2420.5,28.2969 A2.5,2.5 0 0 1 2423,30.7969 L2423,100.5 A2.5,2.5 0 0 1 2420.5,103 L1774.5,103 A2.5,2.5 0 0 1 1772,100.5 L1772,8.5 A2.5,2.5 0 0 1 1774.5,6 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1772" x2="1894" y1="28.2969" y2="28.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="109" x="1776" y="20.9951">Orchestration</text></g><!--MD5=[ba226539c4debab33a2842bfefc0569c]
entity SharedObs--><g id="elem_SharedObs"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="279" y="461"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="427" y="466"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="425" y="468"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="425" y="472"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="294" y="493.9951">Shared Obs Space</text></g><!--MD5=[94ccc613542fd96e10ebb1b8b0286b12]
entity NestedObs--><g id="elem_NestedObs"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="222" x="22" y="461"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="224" y="466"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="222" y="468"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="222" y="472"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182" x="37" y="493.9951">Nested Agent Obs Spaces</text></g><!--MD5=[71abfda12d91064efa5ac0f73d53d315]
entity BaseEnv--><g id="elem_BaseEnv"><ellipse cx="341" cy="338" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="311" y="367.9951">BaseEnv</text></g><!--MD5=[d5d09bea273937fb6514b978292e9a5f]
entity Policy--><g id="elem_Policy"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="1444.5" y="607"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1545.5" y="612"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1543.5" y="614"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1543.5" y="618"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1459.5" y="639.9951">Policy (MLP)</text></g><!--MD5=[d7735d92f2a41b821568342a009b1039]
entity Value--><g id="elem_Value"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="801" y="607"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="901" y="612"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="899" y="614"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="899" y="618"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="816" y="639.9951">Value (MLP)</text></g><!--MD5=[9f1c48fc0a1d5711c690c6ce4c67262a]
entity LSTMPolicy--><g id="elem_LSTMPolicy"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209" x="956.5" y="607"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1145.5" y="612"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1143.5" y="614"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1143.5" y="618"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="971.5" y="639.9951">LSTMPolicy (CNN+LSTM)</text></g><!--MD5=[0cee4d3e9b2a9db7b165b6f3a607c88f]
entity LSTMValue--><g id="elem_LSTMValue"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="208" x="1201" y="607"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1389" y="612"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1387" y="614"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1387" y="618"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="1216" y="639.9951">LSTMValue (CNN+LSTM)</text></g><!--MD5=[4302d7f124f44455c94926a5b6129573]
entity MAPPO--><g id="elem_MAPPO"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="617" y="461"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="725" y="466"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="723" y="468"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="723" y="472"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="632" y="493.9951">MAPPO (skrl)</text></g><!--MD5=[765686b15e6915b3e194a55dec21385a]
entity MultiAgent--><g id="elem_MultiAgent"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="151" x="593.5" y="607"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="724.5" y="612"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="722.5" y="614"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="722.5" y="618"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="608.5" y="639.9951">MultiAgent (skrl)</text></g><!--MD5=[82ab3486416650e04758947ef9448e6c]
entity train_role--><g id="elem_train_role"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="1512.5" y="171"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1595.5" y="176"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1593.5" y="178"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1593.5" y="182"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="1527.5" y="203.9951">train_role</text></g><!--MD5=[d37ce62dc82098b9ebf8685db085366f]
entity train_simultaneously_and_evaluate--><g id="elem_train_simultaneously_and_evaluate"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="278" x="1003" y="171"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1261" y="176"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1259" y="178"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1259" y="182"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="1018" y="203.9951">train_simultaneously_and_evaluate</text></g><!--MD5=[f7aa33cf40c5711e02358f1afa15879d]
entity copy_role_models--><g id="elem_copy_role_models"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="977" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1121" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1119" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1119" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="992" y="347.9951">copy_role_models</text></g><!--MD5=[adb8d2734fa9fe455d55cf2a891d4b5f]
entity initialize_lstm_models_for_mappo--><g id="elem_initialize_lstm_models_for_mappo"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="268" x="1176" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1424" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1422" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1422" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="228" x="1191" y="347.9951">initialize_lstm_models_for_mappo</text></g><!--MD5=[a6f5ab1153a9314980d3747ee9b9cfe1]
entity initialize_models_for_mappo--><g id="elem_initialize_models_for_mappo"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="232" x="608" y="171"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="820" y="176"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="818" y="178"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="818" y="182"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="192" x="623" y="203.9951">initialize_models_for_mappo</text></g><!--MD5=[73f497122e5e9c64bdde68accfb1eb4d]
entity evaluate_agents--><g id="elem_evaluate_agents"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="788.5" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="921.5" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="919.5" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="919.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="803.5" y="347.9951">evaluate_agents</text></g><!--MD5=[fc825ff9579edcdb2fed4f9e68b11482]
entity evaluate_agent--><g id="elem_evaluate_agent"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="608.5" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="733.5" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="731.5" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="731.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="623.5" y="347.9951">evaluate_agent</text></g><!--MD5=[c5719716066d2313087d5e7dca27c70a]
entity policy_archive_utils--><g id="elem_policy_archive_utils"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="1479" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1629" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1627" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1627" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1494" y="347.9951">policy_archive_utils</text></g><!--MD5=[114679d29865933c3bd9b887afc9f029]
entity Policy Archive--><g id="elem_Policy Archive"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="1863.5" y="461"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1976.5" y="466"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1974.5" y="468"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1974.5" y="472"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="1878.5" y="493.9951">Policy Archive</text></g><!--MD5=[3c2ac111f7044adb1020bc6da39d4cea]
entity sample_policy_from_archive--><g id="elem_sample_policy_from_archive"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="230" x="1940" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2150" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2148" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2148" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="1955" y="347.9951">sample_policy_from_archive</text></g><!--MD5=[9a7b1570a76a7ab6c5b9e40f11ef5ab0]
entity update_policy_win_rate--><g id="elem_update_policy_win_rate"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="199" x="1705.5" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1884.5" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1882.5" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1882.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="1720.5" y="347.9951">update_policy_win_rate</text></g><!--MD5=[c9857bef264e46785f7d80258775ef7c]
entity add_policy_to_archive--><g id="elem_add_policy_to_archive"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189" x="2205.5" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2374.5" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2372.5" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2372.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149" x="2220.5" y="347.9951">add_policy_to_archive</text></g><!--MD5=[5fc0ff5be1193906e705ae1ee6845a6a]
entity _orchestrate_training_phase--><g id="elem__orchestrate_training_phase"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="235" x="2171.5" y="41"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2386.5" y="46"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2384.5" y="48"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2384.5" y="52"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195" x="2186.5" y="73.9951">_orchestrate_training_phase</text></g><!--MD5=[d2178cbff11b3ee33e84a33f5be06c12]
entity _orchestrate_simultaneous_training_iteration--><g id="elem__orchestrate_simultaneous_training_iteration"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="348" x="1788" y="41"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2116" y="46"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2114" y="48"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2114" y="52"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="1803" y="73.9951">_orchestrate_simultaneous_training_iteration</text></g><!--MD5=[004b77dd2dbac6a595f9a0112357dbe2]
entity PFSP & Archive--><g id="elem_PFSP &amp; Archive"><rect fill="#F1F1F1" height="46.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145" x="2429.5" y="315"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="2554.5" y="320"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2552.5" y="322"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="2552.5" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="2444.5" y="347.9951">PFSP &amp; Archive</text></g><!--MD5=[6475202817fbdaf8a56e5ac469a0d9f1]
link BaseEnv to SharedObs--><g id="link_BaseEnv_SharedObs"><path d="M331.85,346.51 C317.71,359.07 293.08,385.41 302,410 C308.43,427.73 321.26,444.17 333.5,456.94 " fill="none" id="BaseEnv-to-SharedObs" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="337.28,460.78,333.8187,451.5594,333.7731,457.2161,328.1164,457.1705,337.28,460.78" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="303" y="406.0669">uses</text></g><!--MD5=[e37a33c989c5ed00e14594ca49ac6a38]
link BaseEnv to NestedObs--><g id="link_BaseEnv_NestedObs"><path d="M331.6,345.26 C316.61,355.26 286.39,375.51 261,393 C229.6,414.64 194.15,439.61 168.53,457.75 " fill="none" id="BaseEnv-to-NestedObs" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="164.18,460.83,173.8357,458.8891,168.2593,457.9387,169.2097,452.3623,164.18,460.83" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="262" y="406.0669">uses</text></g><!--MD5=[a093374c54bacbc26fdb60b0949b8041]
link MAPPO to MultiAgent--><g id="link_MAPPO_MultiAgent"><path d="M679.15,507.18 C677.04,532.48 673.59,573.86 671.31,601.27 " fill="none" id="MAPPO-to-MultiAgent" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="670.87,606.55,675.6015,597.9121,671.284,601.5672,667.629,597.2497,670.87,606.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[97d396d09c8384c4a029ea8c9a7d5086]
link MAPPO to Policy--><g id="link_MAPPO_Policy"><path d="M745.02,487.06 C902.27,492.87 1303.58,512.44 1426,564 C1446.97,572.83 1466.75,589.11 1481.26,603.16 " fill="none" id="MAPPO-to-Policy" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1484.84,606.68,1481.2302,597.5165,1481.276,603.1732,1475.6193,603.219,1484.84,606.68" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="1395" y="552.0669">uses</text></g><!--MD5=[19fa00ddf2dfff58878411f3d2fda272]
link MAPPO to Value--><g id="link_MAPPO_Value"><path d="M708.73,507.18 C741.23,533.19 794.99,576.19 829.17,603.54 " fill="none" id="MAPPO-to-Value" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="833.24,606.79,828.7227,598.0382,829.3398,603.6613,823.7168,604.2785,833.24,606.79" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="767" y="552.0669">uses</text></g><!--MD5=[19a812272a37977e0aca416b678fc4d2]
link MAPPO to LSTMPolicy--><g id="link_MAPPO_LSTMPolicy"><path d="M745.01,501.08 C797.73,515.17 873.95,537.51 938,564 C965.83,575.51 995.73,591.23 1019.08,604.32 " fill="none" id="MAPPO-to-LSTMPolicy" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1023.66,606.91,1017.7855,599.0049,1019.3048,604.4539,1013.8558,605.9733,1023.66,606.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="919" y="552.0669">uses</text></g><!--MD5=[ea7a26efaec0869d5e27ee30665b3c7f]
link MAPPO to LSTMValue--><g id="link_MAPPO_LSTMValue"><path d="M745.22,488.27 C842.28,494.72 1031.14,513.2 1183,564 C1212.45,573.85 1243.29,590.34 1266.59,604.25 " fill="none" id="MAPPO-to-LSTMValue" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="1271.15,607,1265.4905,598.9396,1266.8625,604.4275,1261.3746,605.7995,1271.15,607" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="1158" y="552.0669">uses</text></g><!--MD5=[a4d9f78d3001d7b4d75e9a4c6b63f84a]
link BaseEnv to MAPPO--><g id="link_BaseEnv_MAPPO"><path d="M342.15,347.28 C344.76,362.56 352.65,394.99 374,410 C390.25,421.42 443.5,414.26 463,418 C514.54,427.9 571.31,445.03 613.99,459.22 " fill="none" id="BaseEnv-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="618.86,460.85,611.5748,454.2224,614.1137,459.2774,609.0587,461.8164,618.86,460.85" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="375" y="406.0669">step/reset</text></g><!--MD5=[538695e14a0aa4bca5486fb2284f8915]
link MAPPO to BaseEnv--><g id="link_MAPPO_BaseEnv"><path d="M616.74,461.73 C577.14,448.09 525.58,429.36 481,410 C455.97,399.13 384.41,361.81 354.45,346.08 " fill="none" id="MAPPO-to-BaseEnv" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="350.01,343.75,356.1041,351.4871,354.4324,346.0829,359.8366,344.4112,350.01,343.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="482" y="406.0669">actions</text></g><!--MD5=[f9ea388a87043eef3da6dd198a704214]
link copy_role_models to MAPPO--><g id="link_copy_role_models_MAPPO"><path d="M1013.34,361.08 C996.42,368.98 976.98,377.71 959,385 C888.79,413.45 806.82,441.77 750.17,460.59 " fill="none" id="copy_role_models-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="745.11,462.27,754.9105,463.2452,749.8577,460.7017,752.4012,455.6489,745.11,462.27" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6520657fca3bf807ee6653b432dfda82]
link initialize_lstm_models_for_mappo to MAPPO--><g id="link_initialize_lstm_models_for_mappo_MAPPO"><path d="M1241.89,361.06 C1215.8,369.13 1185.66,377.99 1158,385 C1014.09,421.48 843.16,454.02 750,470.87 " fill="none" id="initialize_lstm_models_for_mappo-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="745.07,471.76,754.6433,474.0733,749.9882,470.8593,753.2022,466.2041,745.07,471.76" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7b9e4dbdebeaf0ae506368dc9dab7154]
link initialize_models_for_mappo to MAPPO--><g id="link_initialize_models_for_mappo_MAPPO"><path d="M657.17,217.09 C631.79,229.11 605.53,246.81 591,272 C565.91,315.51 572.77,338.2 591,385 C602.32,414.06 626.73,439.72 647.27,457.49 " fill="none" id="initialize_models_for_mappo-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="651.33,460.94,647.0806,452.0551,647.5267,457.6943,641.8874,458.1404,651.33,460.94" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[45614fbfef630e9631e0e9dc8ad6e124]
link evaluate_agents to MAPPO--><g id="link_evaluate_agents_MAPPO"><path d="M836.65,361.18 C803.43,387.19 748.47,430.19 713.54,457.54 " fill="none" id="evaluate_agents-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="709.38,460.79,718.9328,458.3932,713.3175,457.7085,714.0023,452.0932,709.38,460.79" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[1c2613c0083329070c636573c26fef67]
link evaluate_agent to MAPPO--><g id="link_evaluate_agent_MAPPO"><path d="M681,361.18 C681,386.48 681,427.86 681,455.27 " fill="none" id="evaluate_agent-to-MAPPO" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="681,460.55,685,451.55,681,455.55,677,451.55,681,460.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[41c80bd3a9ac55c9f049021dcab9c217]
link train_role to copy_role_models--><g id="link_train_role_copy_role_models"><path d="M1512.26,204.26 C1406.56,223.24 1174.4,265.37 1158,272 C1133.72,281.82 1109.1,297.95 1090.48,311.69 " fill="none" id="train_role-to-copy_role_models" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1086.36,314.77,1095.9687,312.6084,1090.372,311.786,1091.1943,306.1893,1086.36,314.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c2c1c160dab30bf07951a3c59c6cf8f7]
link train_role to initialize_lstm_models_for_mappo--><g id="link_train_role_initialize_lstm_models_for_mappo"><path d="M1524.59,217.03 C1478.42,242.84 1402.15,285.48 1354.06,312.37 " fill="none" id="train_role-to-initialize_lstm_models_for_mappo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1349.5,314.92,1359.3065,314.0077,1353.8613,312.4748,1355.3942,307.0296,1349.5,314.92" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[2cef3734b2fe004cbadcf79f522038c3]
link train_role to evaluate_agents--><g id="link_train_role_evaluate_agents"><path d="M1512.16,201.66 C1415.82,214.01 1202.66,241.31 1023,264 C994.56,267.59 985.78,261.78 959,272 C935.05,281.14 911.32,297.62 893.7,311.69 " fill="none" id="train_role-to-evaluate_agents" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="889.81,314.84,899.3231,312.2902,893.6976,311.6957,894.2921,306.0701,889.81,314.84" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[8b3941742ac63afbae92344e008668d2]
link train_role to policy_archive_utils--><g id="link_train_role_policy_archive_utils"><path d="M1564,217.19 C1564,242.2 1564,282.87 1564,309.78 " fill="none" id="train_role-to-policy_archive_utils" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1564,314.97,1568,305.97,1564,309.97,1560,305.97,1564,314.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[03aa5fc568a32de4c5a0c34b7f33aa32]
link train_role to sample_policy_from_archive--><g id="link_train_role_sample_policy_from_archive"><path d="M1615.75,202.09 C1686.34,212.67 1816.11,235.35 1922,272 C1952.98,282.72 1986.11,298.9 2011.55,312.43 " fill="none" id="train_role-to-sample_policy_from_archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2016.21,314.92,2010.1551,307.1522,2011.7994,312.5648,2006.3868,314.2092,2016.21,314.92" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[0c425f535b0b7f93aff4542083237fda]
link train_role to update_policy_win_rate--><g id="link_train_role_update_policy_win_rate"><path d="M1601.39,217.03 C1645.2,242.84 1717.57,285.48 1763.19,312.37 " fill="none" id="train_role-to-update_policy_win_rate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1767.52,314.92,1761.7976,306.9041,1763.2125,312.3812,1757.7355,313.7961,1767.52,314.92" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[fa0c960ed53c598eac1f2eb470f86e96]
link train_simultaneously_and_evaluate to initialize_lstm_models_for_mappo--><g id="link_train_simultaneously_and_evaluate_initialize_lstm_models_for_mappo"><path d="M1168.25,217.19 C1198.46,242.72 1247.97,284.57 1279.76,311.44 " fill="none" id="train_simultaneously_and_evaluate-to-initialize_lstm_models_for_mappo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1283.93,314.97,1279.6284,306.1102,1280.1077,311.7467,1274.4711,312.2259,1283.93,314.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a2e5a238a61305ed8cf36943e2a9995c]
link train_simultaneously_and_evaluate to evaluate_agents--><g id="link_train_simultaneously_and_evaluate_evaluate_agents"><path d="M1002.77,214.43 C960.22,222.69 920.33,233.56 904,247 C884.97,262.66 874.99,289.38 869.91,309.65 " fill="none" id="train_simultaneously_and_evaluate-to-evaluate_agents" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="868.72,314.65,874.6968,306.822,869.8787,309.7861,866.9146,304.968,868.72,314.65" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a26a7aa1cf0592abfb48b55385c8914b]
link train_simultaneously_and_evaluate to evaluate_agent--><g id="link_train_simultaneously_and_evaluate_evaluate_agent"><path d="M1002.72,209.23 C931.13,220.14 843.86,239.15 771,272 C748.81,282 726.61,297.96 709.81,311.56 " fill="none" id="train_simultaneously_and_evaluate-to-evaluate_agent" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="705.66,314.96,715.1627,312.372,709.5349,311.8,710.1068,306.1722,705.66,314.96" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c36753432a9926c4fdfe745a08b69665]
link _orchestrate_training_phase to train_role--><g id="link__orchestrate_training_phase_train_role"><path d="M2232.23,87.03 C2208.37,95.58 2180.14,104.79 2154,111 C1961.31,156.78 1726.72,179.96 1620.77,188.73 " fill="none" id="_orchestrate_training_phase-to-train_role" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1615.51,189.16,1624.8103,192.401,1620.4928,188.746,1624.1479,184.4285,1615.51,189.16" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c7865012952cc7a29f65eee7d10894bb]
link _orchestrate_training_phase to add_policy_to_archive--><g id="link__orchestrate_training_phase_add_policy_to_archive"><path d="M2289.9,87.26 C2291.9,136.79 2296.72,255.99 2298.9,309.81 " fill="none" id="_orchestrate_training_phase-to-add_policy_to_archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2299.1,314.82,2302.7371,305.6673,2298.9002,309.824,2294.7435,305.9871,2299.1,314.82" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[5b1b6ba8f9de7469caeade040a2367ea]
link _orchestrate_simultaneous_training_iteration to train_simultaneously_and_evaluate--><g id="link__orchestrate_simultaneous_training_iteration_train_simultaneously_and_evaluate"><path d="M1787.9,86.47 C1699.94,97.83 1591.65,112.59 1495,128 C1416.13,140.57 1327.76,156.85 1259.16,169.97 " fill="none" id="_orchestrate_simultaneous_training_iteration-to-train_simultaneously_and_evaluate" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1253.84,170.99,1263.4274,173.2443,1258.7526,170.059,1261.9379,165.3842,1253.84,170.99" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[e920ba6e9b5248dc3bcfc0b8c480f60b]
link _orchestrate_simultaneous_training_iteration to add_policy_to_archive--><g id="link__orchestrate_simultaneous_training_iteration_add_policy_to_archive"><path d="M1989.37,87.03 C2051.35,136.9 2202.12,258.24 2268.15,311.37 " fill="none" id="_orchestrate_simultaneous_training_iteration-to-add_policy_to_archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2272.37,314.77,2267.8684,306.0101,2268.4755,311.6343,2262.8513,312.2414,2272.37,314.77" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7713c39a5d0d2643202fac6e8bb03e43]
link policy_archive_utils to Policy Archive--><g id="link_policy_archive_utils_Policy Archive"><path d="M1619.99,361.03 C1687.26,387.49 1799.71,431.74 1869.1,459.04 " fill="none" id="policy_archive_utils-to-Policy Archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1874.02,460.98,1867.1119,453.9602,1869.3678,459.1478,1864.1803,461.4037,1874.02,460.98" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6b14f12ccee47c580d024e359b465cd3]
link sample_policy_from_archive to Policy Archive--><g id="link_sample_policy_from_archive_Policy Archive"><path d="M2035.74,361.18 C2013.42,386.9 1976.66,429.25 1952.89,456.63 " fill="none" id="sample_policy_from_archive-to-Policy Archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1949.49,460.55,1958.4089,456.3724,1952.7663,456.773,1952.3657,451.1303,1949.49,460.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d7bb6765f1c1e173dec453f118376f01]
link update_policy_win_rate to Policy Archive--><g id="link_update_policy_win_rate_Policy Archive"><path d="M1824.26,361.18 C1846.58,386.9 1883.34,429.25 1907.11,456.63 " fill="none" id="update_policy_win_rate-to-Policy Archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1910.51,460.55,1907.6343,451.1303,1907.2337,456.773,1901.5911,456.3724,1910.51,460.55" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4be540883aeebcd1ed399e28f317914f]
link add_policy_to_archive to Policy Archive--><g id="link_add_policy_to_archive_Policy Archive"><path d="M2247.13,361.05 C2228.49,368.74 2207.35,377.35 2188,385 C2122.28,410.97 2046.64,439.55 1994.34,459.11 " fill="none" id="add_policy_to_archive-to-Policy Archive" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1989.35,460.97,1999.1815,461.5552,1994.0316,459.2144,1996.3725,454.0646,1989.35,460.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[ce8296b8cabf40072b1e2c853e3499f4]
link train_role to PFSP & Archive--><g id="link_train_role_PFSP &amp; Archive"><path d="M1615.75,196.17 C1776.26,200.35 2263.75,217.34 2411,272 C2434.49,280.72 2457.43,297.17 2474.39,311.34 " fill="none" id="train_role-to-PFSP &amp; Archive" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="2478.58,314.88,2474.2948,306.0123,2474.7636,311.6496,2469.1262,312.1185,2478.58,314.88" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="2375" y="260.0669">uses PFSP</text></g><!--MD5=[0f212577a26b9cdc0df59ffb79cdb95c]
link train_role to evaluate_agent--><g id="link_train_role_evaluate_agent"><path d="M1512.32,199.27 C1368.96,211.14 974.92,243.84 947,247 C937.19,248.11 780.16,268.31 771,272 C748.09,281.24 725.57,297.51 708.78,311.47 " fill="none" id="train_role-to-evaluate_agent" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="704.64,314.96,714.0998,312.2192,708.4634,311.738,708.9446,306.1016,704.64,314.96" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="948" y="260.0669">evaluation</text></g><!--MD5=[482a9d926539b06259809f03f973e730]
@startuml
package "Observation Spaces" {
    [Shared Obs Space] as SharedObs
    [Nested Agent Obs Spaces] as NestedObs
    BaseEnv - -> SharedObs : uses
    BaseEnv - -> NestedObs : uses
}

package "Models" {
    [Policy (MLP)] as Policy
    [Value (MLP)] as Value
    [LSTMPolicy (CNN+LSTM)] as LSTMPolicy
    [LSTMValue (CNN+LSTM)] as LSTMValue
}

package "MAPPO_Agent" {
    [MAPPO (skrl)] as MAPPO
    [MultiAgent (skrl)] as MultiAgent
    MAPPO - -> MultiAgent
    MAPPO ..> Policy : uses
    MAPPO ..> Value : uses
    MAPPO ..> LSTMPolicy : uses
    MAPPO ..> LSTMValue : uses
}

package "Training_Utils" {
    [train_role]
    [train_simultaneously_and_evaluate]
    [copy_role_models]
    [initialize_lstm_models_for_mappo]
    [initialize_models_for_mappo]
    [evaluate_agents]
    [evaluate_agent]
    [policy_archive_utils]
}

package "PFSP & Archive" {
    [Policy Archive]
    [sample_policy_from_archive]
    [update_policy_win_rate]
    [add_policy_to_archive]
}

package "Orchestration" {
    [_orchestrate_training_phase]
    [_orchestrate_simultaneous_training_iteration]
}

BaseEnv - -> MAPPO : step/reset
MAPPO - -> BaseEnv : actions

[copy_role_models] - -> MAPPO
[initialize_lstm_models_for_mappo] - -> MAPPO
[initialize_models_for_mappo] - -> MAPPO
[evaluate_agents] - -> MAPPO
[evaluate_agent] - -> MAPPO

[train_role] - -> [copy_role_models]
[train_role] - -> [initialize_lstm_models_for_mappo]
[train_role] - -> [evaluate_agents]
[train_role] - -> [policy_archive_utils]
[train_role] - -> [sample_policy_from_archive]
[train_role] - -> [update_policy_win_rate]

[train_simultaneously_and_evaluate] - -> [initialize_lstm_models_for_mappo]
[train_simultaneously_and_evaluate] - -> [evaluate_agents]
[train_simultaneously_and_evaluate] - -> [evaluate_agent]

[_orchestrate_training_phase] - -> [train_role]
[_orchestrate_training_phase] - -> [add_policy_to_archive]
[_orchestrate_simultaneous_training_iteration] - -> [train_simultaneously_and_evaluate]
[_orchestrate_simultaneous_training_iteration] - -> [add_policy_to_archive]

[policy_archive_utils] - -> [Policy Archive]
[sample_policy_from_archive] - -> [Policy Archive]
[update_policy_win_rate] - -> [Policy Archive]
[add_policy_to_archive] - -> [Policy Archive]

[train_role] ..> [PFSP & Archive] : uses PFSP
[train_role] ..> [evaluate_agent] : evaluation
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>